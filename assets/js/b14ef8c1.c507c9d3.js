"use strict";(self.webpackChunk_graphql_mesh_website=self.webpackChunk_graphql_mesh_website||[]).push([[5855],{5318:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var r=n(7378);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),u=i,g=d["".concat(s,".").concat(u)]||d[u]||m[u]||a;return n?r.createElement(g,o(o({ref:t},c),{},{components:n})):r.createElement(g,o({ref:t},c))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<a;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6459:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return p},default:function(){return m}});var r=n(5773),i=n(808),a=(n(7378),n(5318)),o=["components"],l={id:"type-merging",title:"Type Merging Transform",sidebar_label:"Type Merging"},s={unversionedId:"transforms/type-merging",id:"transforms/type-merging",isDocsHomePage:!1,title:"Type Merging Transform",description:"This transform helps you to use Type Merging approach of Schema Stitching in your GraphQL Mesh sources.",source:"@site/docs/transforms/type-merging.md",sourceDirName:"transforms",slug:"/transforms/type-merging",permalink:"/docs/transforms/type-merging",editUrl:"https://github.com/urigo/graphql-mesh/edit/master/website/docs/transforms/type-merging.md",version:"current",sidebar_label:"Type Merging",frontMatter:{id:"type-merging",title:"Type Merging Transform",sidebar_label:"Type Merging"},sidebar:"sidebar",previous:{title:"Naming Convention Transform",permalink:"/docs/transforms/naming-convention"},next:{title:"Apollo Federation Transform",permalink:"/docs/transforms/federation"}},p=[{value:"Config API Reference",id:"config-api-reference",children:[]}],c={toc:p};function m(e){var t=e.components,n=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This transform helps you to use ",(0,a.kt)("a",{parentName:"p",href:"https://www.graphql-tools.com/docs/stitch-type-merging"},"Type Merging")," approach of Schema Stitching in your GraphQL Mesh sources."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If you don't know when to use ",(0,a.kt)("inlineCode",{parentName:"p"},"Type Merging"),", please check\n",(0,a.kt)("a",{parentName:"p",href:"/docs/recipes/multiple-apis#merging-types-from-different-sources-using-type-merging"},"Merging types from different sources (using Type Merging)")," chapter first.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"sources:\n  - name: AuthorService\n    handler:\n      graphql:\n        endpoint: ./author-service-schema.js\n    transforms:\n      - typeMerging:\n          queryFields:\n            # No need to define which type it belongs\n            # And no need to define a key for type\n            # keyField assigns to that type automatically\n            - queryFieldName: authors\n              # Mesh automatically does batching if return type is a list\n              keyField: id\n            # keyArg: ids <-- This is needed if you have multiple args\n            #                for that query field\n  - name: BookService\n    handler:\n      graphql:\n        endpoint: ./book-service-schema.js\n    transforms:\n      # Rename type names and field names to let stitching merger merges them\n      - rename:\n          renames:\n            - from:\n                type: AuthorWithBooks\n              to:\n                type: Author\n            - from:\n                type: Query\n                field: authorWithBooks\n              to:\n                type: Query\n                field: author\n      - typeMerging:\n          queryFields:\n            # This doesn't use batching\n            # It does regular stitching\n            - queryFieldName: book\n              keyField: id\n            - queryFieldName: author\n              keyField: id\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"You can check out our example that uses Type Merging")),(0,a.kt)("iframe",{src:"https://codesandbox.io/embed/github/Urigo/graphql-mesh/tree/master/examples/type-merging-batching-example?fontsize=14&hidenavigation=1&theme=dark&module=%2F.meshrc.yml",style:{width:"100%",height:"500px",border:"0",borderRadius:"4px",overflow:"hidden"},title:"federation-example",allow:"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb",sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin"}),(0,a.kt)("h2",{id:"config-api-reference"},"Config API Reference"),(0,a.kt)("p",null,(0,a.kt)("ul",{parentName:"p"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"types")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Array of Object"),", required): ",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"typeName")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"String"),") - Name of the type (Query by default)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"key")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Object"),") - Specifies a base selection set needed to merge the annotated type across subschemas.\nAnalogous to the ",(0,a.kt)("inlineCode",{parentName:"li"},"selectionSet")," setting specified in ",(0,a.kt)("a",{parentName:"li",href:"https://www.graphql-tools.com/docs/stitch-type-merging#basic-example"},"merged type configuration"),".: ",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"* `selectionSet` (type: `String`, required)\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"canonical")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Boolean"),") - Specifies types and fields\nthat provide a ",(0,a.kt)("a",{parentName:"li",href:"https://www.graphql-tools.com/docs/stitch-type-merging#canonical-definitions"},"canonical definition")," to be built into the gateway schema. Useful for selecting preferred characteristics among types and fields that overlap across subschemas. Root fields marked as canonical specify which subschema the field proxies for new queries entering the graph."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"fields")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Array of Object"),", required): ",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"* `fieldName` (type: `String`, required)\n* `computed` (type: `Object`) - specifies a selection of fields required from other services to compute the value of this field.\n")),"These additional fields are only selected when the computed field is requested.\nAnalogous to ",(0,a.kt)("a",{parentName:"li",href:"https://www.graphql-tools.com/docs/stitch-type-merging#computed-fields"},"computed field")," in merged type configuration.\nComputed field dependencies must be sent into the subservice using an ",(0,a.kt)("a",{parentName:"li",href:"https://www.graphql-tools.com/docs/stitch-directives-sdl#object-keys"},"object key"),".: ",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"  * `selectionSet` (type: `String`, required)\n"))))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"queryFields")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Array of Object"),", required) - Denotes a root field used to query a merged type across services.\nThe marked field's name is analogous\nto the fieldName setting in\n",(0,a.kt)("a",{parentName:"li",href:"https://www.graphql-tools.com/docs/stitch-type-merging#basic-example"},"merged type configuration"),",\nwhile the field's arguments and return type are used to infer merge configuration.\nDirective arguments tune the merge behavior: ",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"queryFieldName")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"String"),", required)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"keyField")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"String"),") - Specifies the name of a field to pick off origin objects as the key value. When omitted, a ",(0,a.kt)("inlineCode",{parentName:"li"},"@key")," directive must be included on the return type's definition to be built into an object key.\n",(0,a.kt)("a",{parentName:"li",href:"https://www.graphql-tools.com/docs/stitch-directives-sdl#object-keys"},"https://www.graphql-tools.com/docs/stitch-directives-sdl#object-keys")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"keyArg")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"String"),") - Specifies which field argument receives the merge key. This may be omitted for fields with only one argument where the recipient can be inferred."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"additionalArgs")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"String"),") - Specifies a string of additional keys and values to apply to other arguments,\nformatted as ",(0,a.kt)("inlineCode",{parentName:"li"},'\\"\\"\\" arg1: "value", arg2: "value" \\"\\"\\"'),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"key")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Array of String"),", required) - Advanced use only; Allows building a custom key just for the argument from the selectionSet included by the ",(0,a.kt)("inlineCode",{parentName:"li"},"@key")," directive."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"argsExpr")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"String"),") - Advanced use only; This argument specifies a string expression that allows more customization of the input arguments. Rules for evaluation of this argument are as follows:")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"basic object parsing of the input key: ",(0,a.kt)("inlineCode",{parentName:"li"},'"arg1: $key.arg1, arg2: $key.arg2"')),(0,a.kt)("li",{parentName:"ul"},"any expression enclosed by double brackets will be evaluated once for each of the requested keys, and then sent as a list: ",(0,a.kt)("inlineCode",{parentName:"li"},'"input: { keys: [[$key]] }"')),(0,a.kt)("li",{parentName:"ul"},"selections from the key can be referenced by using the $ sign and dot notation: ",(0,a.kt)("inlineCode",{parentName:"li"},'"upcs: [[$key.upc]]"'),", so that ",(0,a.kt)("inlineCode",{parentName:"li"},"$key.upc")," refers to the ",(0,a.kt)("inlineCode",{parentName:"li"},"upc")," field of the key."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"additionalConfiguration")," (type: ",(0,a.kt)("inlineCode",{parentName:"li"},"Any"),") - The path to a code file that has additional type merging configuration"))))}m.isMDXComponent=!0}}]);